# Wellio - AI Agent For Smarter Coaching

## Overview
Wellio is an AI-powered fitness & wellness coaching platform MVP designed to help professionals manage their coaching practice efficiently. It provides client insights and streamlines workflows, aiming to enhance coaching effectiveness and client outcomes. The platform features a modern dashboard, client management, questionnaire building, progress analytics, smart scheduling, communication tools, and AI-driven insights for personalized recommendations. Wellio aims to be a comprehensive solution for coaches looking to optimize their practice with technology.

## User Preferences
- Brand colors must be #E2F9AD (lime) and #28A0AE (teal)
- All visible UI buttons must be functional (no dead interactions)
- PostgreSQL database with Drizzle ORM for data persistence
- Modern, clean aesthetic with professional coaching platform feel
- Questionnaire Builder positioned between Client Management and Progress Analytics in sidebar
- AI Insights and Client Data Logs positioned after Communication in sidebar navigation
- **Mobile-first responsive design** required across all pages with touch-friendly controls (≥40px targets)

## System Architecture

### UI/UX Decisions
The platform utilizes a modern design with React, Tailwind CSS, and Shadcn UI components. It incorporates a teal (#28A0AE) and lime (#E2F9AD) color scheme, supports dark mode, and uses the Inter font family. Interaction patterns include subtle hover and active elevation states for components. The responsive design ensures usability across various viewports, featuring a collapsible sidebar navigation. **Mobile-first responsive implementation** uses consistent Tailwind breakpoints (sm: 640px, md: 768px, lg: 1024px) with reusable layout primitives (StatGrid, ResponsiveSplit, StickyToolbar) for standardized responsive patterns. Touch targets meet ≥40px minimum (h-10) with responsive spacing (p-4 sm:p-6), typography scaling (text-2xl sm:text-3xl), and layouts that stack vertically on mobile (flex-col sm:flex-row).

### Technical Implementations
Wellio is built with a React frontend and an Express.js backend. Data is persisted using PostgreSQL with Drizzle ORM. State management is handled by TanStack Query v5, and form handling uses React Hook Form with Zod validation. Data visualization is powered by Recharts. The system employs UUID primary keys, uses local timezones for date operations, and ensures robust form validation across all inputs. Loading skeletons and error states are implemented for improved user experience. All numeric health metrics (calories, macronutrients, weight, body fat) use the `real` data type to support decimal precision. **AI-Assisted Plan Builder** leverages OpenAI GPT-4 with streaming response support for real-time plan generation. PDF generation uses pdfkit library with custom professional layout, automatic branding, and object storage integration for public access. Plan data structure uses JSONB columns for flexible conversation storage while maintaining referential integrity through foreign keys to clients table.

### Feature Specifications
- **Dashboard**: Real-time stats, client progress distribution, today's schedule, recent activity, AI insights, and active goals widget showing top 5 priority goals with progress tracking.
- **Client Management**: Full CRUD operations for clients, supporting manual entry and questionnaire-based onboarding. Includes client search, progress tracking, status management, and form validation. **Standardized Goal Types**: Replaced free-text goal input with dropdown selector featuring 12 predefined goal types (lose weight, gain muscle/strength, improve body composition, maintain weight, improve health, eat healthier, increase energy, improve fitness/endurance, reduce stress/improve balance, improve sleep/recovery, prepare for event, other). When "Other" is selected, a description field appears for custom goals. All legacy free-text goals automatically migrated to new system. Helper function `getGoalTypeLabel()` ensures consistent human-readable display across all surfaces. **Standard Health Metrics**: Client profiles track 6 configurable health metrics: Sex (dropdown: Male/Female/Other), Age (0-120), Weight (0-1000 lbs, decimal), Height (0-120 inches, decimal), Activity Level (dropdown: Sedentary-1.2, Lightly Active-1.375, Moderately Active-1.55, Very Active-1.725, Extra Active-1.9), and Body Fat % (0-100%, decimal). All metrics stored with proper data types (real for decimals) and NaN validation to prevent data corruption. Coaches can send invite links to clients for self-service onboarding.
- **Questionnaire Builder**: Full CRUD for questionnaires with draft/published workflow. Features a Google Forms-style visual builder supporting **10 question types** (Short Text, Paragraph, Email, Phone, Number, Date, Multiple Choice, Checkboxes, Dropdown, File Upload) with **type-specific settings** including placeholders, validation constraints (min/max length/value/date), unit labels, option management, "Other" option support, file upload constraints (type, size, count), and min/max selection limits for checkboxes. **Standard Health Metrics**: Coaches can enable/disable 6 standard health metrics (Sex, Age, Weight, Height, Activity Level, Body Fat %) via toggle switches—all default to enabled. Standard fields appear after basic info (name, email, phone) but before custom questions. Questionnaire responses automatically populate client health metrics for both new and existing clients with NaN-protected numeric parsing. Questions include label, optional description field, required toggle, and accordion-based editing UI. Form-level settings include welcome text, consent requirement with custom text, and confirmation message. Preview mode shows accurate client-facing form representation with all settings visible. Normalization layer (`normalizeQuestion`) ensures backward compatibility with legacy question formats. Integrates with client management for intake and questionnaire-based onboarding workflow.
- **Progress Analytics**: Tracks key metrics like active clients and average progress over customizable time ranges, with trend charts, goal distribution, and performance insights.
- **Smart Scheduling**: Monthly calendar view for session management, booking forms, and color-coded session types.
- **Communication**: Complete two-way messaging system enabling coaches and clients to exchange messages with **near-real-time updates** via 5-second polling. Features intelligent client list sorting (unread messages first, then by recent activity, then alphabetically), **bidirectional unread tracking** with badges showing unread counts on both coach Communication and client Chat menu items, **global unread indicators** (red dot on hamburger/sidebar trigger when ANY unread messages exist), **bidirectional auto-mark-as-read** (both coach and client automatically mark opposite-sender messages as read when viewing conversation, including auto-marking new incoming messages while conversation is already open), separate coach endpoints (`/api/coach/messages`) and client endpoints (`/api/messages`) with proper authentication, and real-time conversation threading. **UI parity achieved**: both coach and client interfaces use identical left sidebar layout (SidebarProvider + AppSidebar/ClientSidebar) with consistent navigation patterns. Clients access messaging via their authenticated portal at `/client/chat`. **File attachments**: Inline attachment UX with native file picker (click paperclip) and drag-and-drop support. Validates file type, size (25MB max), and count (5 max per message). Supports images (jpeg, png, gif, webp), documents (pdf, txt, csv), and videos (mp4, mov). Files upload immediately to object storage with clientId-scoped ACL. Compact inline preview tray shows file chips with icons, names, sizes, and remove buttons. Loading states with spinner during upload, try/finally guarantees state cleanup. Limit enforcement tracks total attachments across multiple upload batches. Identical attachment UX for both coach and client interfaces.
- **AI Insights Dashboard**: Provides personalized, AI-powered trend analysis for nutrition, activity, and progress categories for individual clients. Includes confidence scoring, actionable recommendations generated by OpenAI GPT-4, and visual trend badges. AI summaries now acknowledge synced vs manual data collection and **incorporate active goals progress** for comprehensive client assessment.
- **Goal Setting & Progress Tracking**: Complete goal management system with CRUD operations for client goals. Features goal types (weight loss, muscle gain, strength, endurance, flexibility, nutrition, habit, other), target/current value tracking, deadline management, status tracking (active/completed/paused/cancelled), and priority levels (high/medium/low). Visual progress bars show completion percentage. Goals tab integrated into Client Data Logs page for per-client management. Dashboard widget displays top 5 active goals across all clients sorted by priority. AI insights incorporate goal progress into recommendations.
- **Client Data Logs**: Tabbed interface for recording nutrition, workout, check-in data, and managing client goals, with nullable number fields for accurate data representation.
- **AI-Assisted Plan Builder**: Interactive plan creation tool powered by OpenAI GPT-4 enabling coaches to create personalized wellness plans through conversational AI. Two-panel layout displays comprehensive client context (goals, nutrition data, workout history, check-ins, questionnaire responses) on the left while providing real-time AI chat interface on the right. System prompt automatically injects complete client data for contextually aware recommendations. Features include conversation memory, streaming responses, plan preview, save/publish workflow, professional PDF generation with branding, and secure plan sharing with clients. Plans saved to database with full CRUD operations. Accessed from client profiles via dedicated route (/coach/plan-builder/:clientId). Client portal displays shared plans with PDF download capability, authenticated with session-based access control.
- **Wearables Integration (ROOK API)**: Two-tier integration architecture supporting 400+ devices. **Web-based ROOK API** handles Garmin, Fitbit, Oura, Whoop, and other devices via OAuth flow. **Native iOS app** handles Apple Health via ROOK iOS SDK with HealthKit integration. Connection request system enables coaches to send invite codes to clients via deep links (wellio://connection-request/{code}). Seamlessly integrated into Client Data Logs page. All data delivered via ROOK webhooks with HMAC signature verification for security. Synced data automatically populates nutrition, workout, and check-in logs with dataSource tracking (manual/rook/apple_health). AI insights recognize and acknowledge wearable data for improved accuracy. Request lifecycle: pending → approved → connected (or rejected/expired), with 7-day expiration.
- **Client Portal**: Complete client-facing interface separate from coach dashboard. **Secure password-based authentication** with session management (express-session + PostgreSQL storage). Onboarding flow: coach sends invite link → client completes questionnaire → client sets password → automatic account creation with session. Client dashboard navigation includes Home, Forms, Chat, and Plan sections. Fully responsive design with dedicated client navigation. Invite system tracks status (pending → completed) with email/token management. All client data is scoped by authenticated session with CSRF protection (sameSite cookies). **Login page enhancements**: Clickable Wellio brand icon (24px logo in 40px tap target) positioned beside header for navigation to app root. Full keyboard accessibility with Tab focus, Enter/Space navigation, WCAG-compliant focus rings, and hover/active elevation states. Password field includes inline visibility toggle positioned inside input field with proper aria-labels for screen readers.

### System Design Choices
All displayed data is sourced from a robust backend, ensuring 100% authenticity without mock or synthetic data. The system is designed for data accuracy, with calculations like success rate and average progress derived directly from live API data. AI insights leverage OpenAI GPT-4 for sophisticated pattern detection and recommendation generation, requiring a minimum of three data points for trend analysis and incorporating zero-baseline protection.

## External Dependencies
- **OpenAI GPT-4**: For AI insight generation and actionable recommendations.
- **ROOK API**: For wearables integration supporting 400+ devices including Garmin, Fitbit, Oura, and Whoop. Uses webhook-based data delivery with HMAC signature verification.
- **ROOK iOS SDK v3.0+**: For Apple Health/HealthKit integration via native iOS app. Handles data extraction, transformation, and secure transmission.
- **iOS Native App (Swift)**: Companion app for Apple Health integration built with HealthKit framework. Handles connection request deep links, HealthKit authorization, and data sync coordination.
- **PostgreSQL**: Primary database for data persistence, managed with Drizzle ORM.
- **Node.js**: Backend runtime environment with crypto module for HMAC verification.
- **React**: Frontend library.
- **Tailwind CSS**: Utility-first CSS framework for styling.
- **Shadcn UI**: UI component library built on Radix UI.
- **Wouter**: React router for client-side navigation.
- **Recharts**: JavaScript library for data visualization.
- **TanStack Query v5**: For data fetching, caching, and state management.
- **React Hook Form**: For form management and validation.
- **Zod**: For schema validation.